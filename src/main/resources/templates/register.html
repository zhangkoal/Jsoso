<!DOCTYPE html>
<html>

<head>
  <title>JSOSO</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css">
  <link rel="stylesheet" href="css/login.css" type="text/css">
  <link rel="shortcut icon" href="img/bitbug_favicon.ico">
  <link rel="bookmark"  type="image/x-icon"  href="img/bitbug_favicon.ico"/>
</head>

<body>
  <div class="py-5">
    <div class="container">
      <div class="row">
        <div class="col-md-6">
          <h1 class="text-danger text-center">WWW.JSOSO.CN</h1>
        </div>
        <div class="col-md-6">
          <div class="card text-white p-5 bg-primary">
            <div class="card-body">
              <h2 class="mb-4 text-center">注册帐号</h2>
              <form action="index" class="form" onsubmit="return checkAction()">
                <div class="form-group"> <label>邮箱</label>
                  <input type="email" id="email" class="form-control" placeholder="输入邮箱"/></div>
                <div class="form-group"> <label>密码</label>
                  <input type="password" class="form-control" placeholder="输入密码"/> </div>
                <div class="form-group"> <label>确认密码</label>
                  <input type="password" class="form-control" placeholder="确认密码"/> </div>
                <div class="form-group"> <label>验证码</label>
                  <input type="text"  style="width: 45%; display: inline-block" class="form-control" placeholder="邮箱验证码"/>
                  <input type="button" style="display: inline-block;margin-left: 5px;width:32%" id="emailCode" value="获取邮箱验证码" class="btn btn-default btn-lg btn-sm active" onclick="getEamilCode();" autocomplete="off"/></div>
                <button type="submit" class="btn btn-block btn-danger login-btn">立即注册</button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="js/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
  <script src="js/popper.min.js" crossorigin="anonymous"></script>
  <script src="js/bootstrapValidator.js" crossorigin="anonymous"></script>
  <script src="js/bootstrap.min.js" crossorigin="anonymous"></script>
  <script>
      function checkAction() {
          $('form').bootstrapValidator({
              message: 'This value is not valid',
              feedbackIcons: {
                  valid: 'glyphicon glyphicon-ok',
                  invalid: 'glyphicon glyphicon-remove',
                  validating: 'glyphicon glyphicon-refresh'
              },
              fields: {
                  username: {
                      message: '用户名验证失败',
                      validators: {
                          notEmpty: {
                              message: '用户名不能为空'
                          }
                      }
                  },
                  email: {
                      validators: {
                          notEmpty: {
                              message: '邮箱地址不能为空'
                          },
                          emailAddress: {
                              message: '邮箱地址格式有误'
                          }
                      }
                  }
              }
          });
          if(message == "") {
              return true;
          }
          return false;
      }
      function getEamilCode(){
          var userMail = jQuery("#email").val();
          if(userMail == undefined || userMail == "") {
              alert("请输入邮箱地址！");
          } else {
              alert("发送成功！");
              if(!jQuery("#emailCode").hasClass('disabled')){
                  jQuery("#emailCode").addClass('disabled');
                  var countDownTime=parseInt(10);    //在这里设置时长
                  jQuery("#emailCode").val(countDownTime+"秒后重新获取");
                  countDown(countDownTime - 1);
              }
              //向后台发送处理数据
              $.ajax({
                  type: "post", //用GET方式传输
                  dataType: "json", //数据格式:JSON
                  url: '/sendMail', //目标地址
                  data: {toUser : userMail},
                  success: function (data) {
                  }
              });
          }
      }
    function countDown(countDownTime){
        var timer=setInterval(function(){
            if(countDownTime>0){
                jQuery("#emailCode").val(countDownTime+"秒后重新获取");
                countDownTime--;
            }else{
                clearInterval(timer);
                jQuery("#emailCode").removeClass('disabled');
                jQuery("#emailCode").val('获取邮箱验证码')
            }
        },1000);
    }

  </script>
</body>

</html>